# People Detection & Tracking System üï∫üë´

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –ª—é–¥–µ–π –≤ –≤–∏–¥–µ–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º YOLOv8. –°–æ–∑–¥–∞–µ—Ç –≤–∏–¥–µ–æ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –¥–µ—Ç–µ–∫—Ü–∏–π, —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ ID –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π.

![–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã](demo.gif) <!-- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä -->

## üîç –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üéØ **–¢–æ—á–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è** —Å YOLOv8 (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π –º–æ–¥–µ–ª–µ–π)
- üÜî **–¢—Ä–µ–∫–∏–Ω–≥** —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ ID (–∞–ª–≥–æ—Ä–∏—Ç–º SORT)
- üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ª—é–¥–µ–π –≤ –∫–∞–¥—Ä–µ
- üñºÔ∏è **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**:
  - –ó–µ–ª–µ–Ω—ã–µ bounding boxes
  - –ú–µ—Ç–∫–∏ —Å ID –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é
  - –°—á–µ—Ç—á–∏–∫ –ª—é–¥–µ–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚ö° **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** –¥–ª—è CPU/GPU
- üìù **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø—Ä–æ—Ü–µ—Å—Å–∞

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.8+
- NVIDIA GPU (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è CUDA —É—Å–∫–æ—Ä–µ–Ω–∏—è)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/Apahc/People_video_detection.git
cd People_video_detection
```
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip install -r requirements.txt
```
3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–ª—è GPU —É—Å–∫–æ—Ä–µ–Ω–∏—è:

```bash
conda install pytorch torchvision torchaudio cudatoolkit=11.3 -c pytorch
```
## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫
```bash
python people_detection_frame_by_frame.py --input crowd.mp4 --output output.mp4
```
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞

–ê—Ä–≥—É–º–µ–Ω—Ç	–û–ø–∏—Å–∞–Ω–∏–µ	–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é

--input	–ü—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É –≤–∏–¥–µ–æ	crowd.mp4

--output	–ü—É—Ç—å –¥–ª—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ	output.mp4

--model	–ú–æ–¥–µ–ª—å YOLOv8 (n, s, m, l, x)	yolov8m.pt

--conf	–ü–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (0.0-1.0)	0.5

--iou	–ü–æ—Ä–æ–≥ IoU –¥–ª—è NMS (0.0-1.0)	0.5

–ü—Ä–∏–º–µ—Ä—ã
```bash
# –° –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
python people_detection_frame_by_frame.py --input video.mp4 --output result.mp4 --model yolov8l.pt --conf 0.6

# –¢–æ–ª—å–∫–æ CPU
CUDA_VISIBLE_DEVICES="" python people_detection_frame_by_frame.py
```

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

## –ê–ø–ø–∞—Ä–∞—Ç—É—Ä–∞ –∏ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ê–ø–ø–∞—Ä–∞—Ç—É—Ä–∞ | –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ | FPS       |
| :---------- | :--------- | :-------- |
| CPU (i7)    | 1280x720   | 4-8       |
| GPU (RTX 3060) | 1920x1080 | 25-35     |


## –ú–æ–¥–µ–ª–∏ YOLOv8 –∏ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

| –ú–æ–¥–µ–ª—å  | mAP@0.5 | –†–∞–∑–º–µ—Ä (MB) | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è       |
| :------- | :------ | :---------- | :------------------ |
| nano     | 0.58    | 6.2         | –î–ª—è CPU             |
| small    | 0.62    | 21          | –ë–∞–ª–∞–Ω—Å              |
| medium   | 0.65    | 49          | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é         |
| large    | 0.67    | 83          | –î–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏         |
| xlarge   | 0.68    | 130         | –î–ª—è –ø–ª–æ—Ç–Ω—ã—Ö —Å—Ü–µ–Ω     |

## üí° –°–æ–≤–µ—Ç—ã –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
–î–ª—è –ø–ª–æ—Ç–Ω—ã—Ö —Ç–æ–ª–ø:

```bash
python people_detection_frame_by_frame.py --model yolov8l.pt --conf 0.6 --iou 0.4
```
–î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏:

# –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
frame = cv2.resize(frame, (1280, 720))

# –≠–∫—Å–ø–æ—Ä—Ç –≤ ONNX
model.export(format='onnx')
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è heatmap
heatmap = generate_heatmap(detections)
frame = overlay_heatmap(frame, heatmap)
